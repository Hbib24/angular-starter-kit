<document filename="field.ts">
  import { TemplateRef } from '@angular/core'; import { FormGroup, ValidatorFn }
  from '@angular/forms';
  <p>
    export type RequiredType = boolean | ((formGroup: FormGroup) => boolean);
    export type VisibilityType = boolean | ((formGroup: FormGroup) => boolean);
  </p>
  <p>
    export interface FieldOptions&#x3C;T, N extends string, R extends
    RequiredType = false, V extends VisibilityType = true, H extends
    VisibilityType = false> { name: N; label?: string | TemplateRef<any
      >; value?: T; placeholder?: string | TemplateRef<any
        >; required?: R; readonly?: boolean | ((formGroup: FormGroup) =>
        boolean); visible?: V; hidden?: H; validators?: ValidatorFn[];
        validationHint?: string | TemplateRef<any
          >; hint?: string | TemplateRef<any
            >; colspan?: number; dependencies?: string[]; formatValue?: (value:
            any) => any; onValueChange?: (value: any) => void; }</any
          ></any
        ></any
      ></any
    >
  </p>
  <p>
    export abstract class Field&#x3C;T, N extends string, R extends RequiredType
    = false, V extends VisibilityType = true, H extends VisibilityType = false>
    { readonly name: N; readonly label?: string | TemplateRef<any
      >; value: T | null; readonly placeholder?: string | TemplateRef<any
        >; readonly required: R; readonly readonly: boolean | ((formGroup:
        FormGroup) => boolean); readonly visible: V; readonly hidden: H;
        readonly validators: ValidatorFn[]; readonly validationHint?: string |
        TemplateRef<any
          >; readonly dependencies: string[]; hint?: string | TemplateRef<any
            >; colspan: number; isTemplate = false; formatValue?: (value: any)
            => any; onValueChange?: (value: any) => void;</any
          ></any
        ></any
      ></any
    >
  </p>
  <p>
    constructor(options: FieldOptions&#x3C;T, N, R, V, H>) { this.name =
    options.name; this.label = options.label; this.value = options.value ??
    null; this.placeholder = options.placeholder || options.label; this.required
    = options.required ?? (false as R); this.readonly = options.readonly ??
    false; this.visible = options.visible ?? (true as V); this.hidden =
    options.hidden ?? (false as H); this.validators = options.validators || [];
    this.validationHint = options.validationHint; this.hint = options.hint;
    this.colspan = options.colspan || 24; this.dependencies =
    options.dependencies || []; this.formatValue = options.formatValue;
    this.onValueChange = options.onValueChange; }
  </p>
  <p>
    isVisible(form: FormGroup) { const isVisible = this.visible; const visible =
    typeof isVisible === 'function' ? isVisible(form) : isVisible; const hidden
    = this.isHidden(form); return visible &#x26;&#x26; !hidden; }
  </p>
  <p>
    private isHidden(form: FormGroup) { const isHidden = this.hidden; return
    typeof isHidden === 'function' ? isHidden(form) : isHidden; }
  </p>
  <p>
    isReadonly(formGroup: FormGroup): boolean { const isReadonly =
    this.readonly; return typeof isReadonly === 'function' ?
    isReadonly(formGroup) : isReadonly; }
  </p>
  <p>
    isRequired(formGroup: FormGroup): boolean { const isRequired =
    this.required; return typeof isRequired === 'function' ?
    isRequired(formGroup) : isRequired; } }
  </p>
  <p>
    export type InferFormValues&#x3C;Fields extends readonly any[]> = { [I in
    keyof Fields as GetFieldName&#x3C;Fields[I]>]: GetValueType&#x3C;Fields[I]>
    };
  </p>
  <p>
    type GetFieldName<f>
      = F extends Field&#x3C;infer T, infer N, any, any, any> ? T extends never
      ? never : N : never;</f
    >
  </p>
  <p>
    type GetValueType<f>
      = F extends Field&#x3C;infer T, any, infer R, infer V, infer H> ? R
      extends true ? V extends true ? H extends false ? T : T | null : T | null
      : T | null : never;</f
    >
  </p>
</document>
<document filename="text-field.ts">
  import { Field, FieldOptions, RequiredType, VisibilityType } from './field';
  // Adjust path as needed
  <p>
    export class TextField&#x3C;N extends string, R extends RequiredType =
    false, V extends VisibilityType = true, H extends VisibilityType = false>
    extends Field&#x3C;string, N, R, V, H> { constructor(options:
    FieldOptions&#x3C;string, N, R, V, H>) { super(options); } }
  </p>
  <document filename="template-field.ts">
    import { Field, FieldOptions, RequiredType, VisibilityType } from './field';
    // Adjust path as needed
    <p>
      export class TemplateField&#x3C;N extends string = '', R extends
      RequiredType = false, V extends VisibilityType = true, H extends
      VisibilityType = false> extends Field&#x3C;never, N, R, V, H> {
      constructor(options: Partial&#x3C;FieldOptions&#x3C;never, N, R, V, H>> =
      {}) { super({ ...options, name: options.name ?? '' as N, });
      this.isTemplate = true; } }
    </p>
    <document filename="home.component.ts">
      import { Component, inject } from '@angular/core'; import { TextField }
      from '../../shared/components/form/fields/text-field'; import {
      FormService } from '../../shared/services/form.service'; import {
      TemplateField } from '../../shared/components/form/fields/template-field';
      import { InferFormValues } from
      '../../shared/components/form/fields/field'; // Adjust path as needed
      <p>
        @Component({ selector: 'app-home', templateUrl: './home.component.html',
        styleUrls: ['./home.component.scss'], standalone: false, }) export class
        HomeComponent { formService = inject(FormService);
      </p>
      <p>
        fields = [ new TextField({ label: 'Password', name: 'password', }), new
        TextField({ label: 'Password check', name: 'passwordcheck', visible:
        (formGroup) => { return formGroup.get('password')?.value; }, required:
        true, dependencies: ['password'], }), new TemplateField({}), ] as const;
      </p>
      <p>
        type HomeFormValues = InferFormValues<typeof this.fields="">;</typeof>
      </p>
      <p>
        onSubmit(data: HomeFormValues) { console.log('Form submitted:', data); }
        }
      </p></document
    ></document
  ></document
>
